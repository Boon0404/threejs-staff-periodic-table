
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Three.js Google Sheet Visualization</title>

  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
      background: #000;
    }

    .element {
      width: 120px;
      height: 160px;
      box-shadow: 0 0 12px rgba(0,255,255,0.5);
      border: 1px solid rgba(255,255,255,0.25);
      text-align: center;
      cursor: default;
    }

    .element .name {
      font-size: 16px;
      font-weight: bold;
      margin-top: 20px;
    }

    .element .company {
      font-size: 12px;
      margin-top: 10px;
    }

    .element .worth {
      font-size: 12px;
      margin-top: 10px;
    }

  #menu {
    position: fixed;
    bottom: 20px;
    width: 100%;
    text-align: center;
    z-index: 9999;
    pointer-events: auto;
  }

    button {
      padding: 8px 12px;
      margin: 0 5px;
      pointer-events: auto;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>

<body>

<div id="menu">
  <button id="table">Table</button>
  <button id="sphere">Sphere</button>
  <button id="helix">Helix</button>
  <button id="grid">Grid</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/TrackballControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/renderers/CSS3DRenderer.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tweenjs/tween.js@18.6.4/dist/tween.umd.js"></script>

<script>
let camera, scene, renderer;
let controls;
let objects = [];
let targets = { table: [], sphere: [], helix: [], grid: [] };

const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR-__UDAHEYxeOWBGnCh9E0PiC3SZDgTX1lkss_AUflep9vIXjNvFfE9xaYJl851IBfktfqaQc3pkdm/pub?output=csv';
		let staffData = [];

	fetch(SHEET_URL)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.trim().split('\n').slice(1);

    staffData = rows.map(row => {
      // Split only first 5 commas
      const firstParts = row.split(',', 5);
      const rest = row.substring(firstParts.join(',').length + 1);

      const name = firstParts[0];
      const photo = firstParts[1];
      const age = firstParts[2];
      const country = firstParts[3];
      const interest = firstParts[4];

      const worth = parseFloat(
        rest.replace(/"/g, '').replace(/[$,]/g, '')
      );

      return { name, photo, age, country, interest, worth };
    });

    init();
    animate();
  });


function init() {

  camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 1, 10000);
  camera.position.z = 3000;

  scene = new THREE.Scene();

  for (let i = 0; i < staffData.length; i++) {

  const staff = staffData[i];
  if (!staff) continue;

  const element = document.createElement('div');
  element.className = 'element';

  if (staff.worth < 100000) {
    element.style.backgroundColor = 'rgba(255,0,0,0.6)';
  } else if (staff.worth < 200000) {
    element.style.backgroundColor = 'rgba(255,165,0,0.6)';
  } else {
    element.style.backgroundColor = 'rgba(0,255,0,0.6)';
  }

  // avatar
  const avatar = document.createElement('img');
  avatar.src = staff.photo;
  avatar.style.position = 'absolute';
  avatar.style.top = '15px';
  avatar.style.left = '50%';
  avatar.style.transform = 'translateX(-50%)';
  avatar.style.width = '60px';
  avatar.style.height = '60px';
  avatar.style.borderRadius = '50%';
  avatar.style.objectFit = 'cover';
  element.appendChild(avatar);

  // name
  const name = document.createElement('div');
  name.textContent = staff.name;
  name.style.marginTop = '85px';
  name.style.fontWeight = 'bold';
  element.appendChild(name);

  // country + worth
  const details = document.createElement('div');
  details.innerHTML = `
    ${staff.country}<br>
    $${staff.worth.toLocaleString()}
  `;
  element.appendChild(details);

  const objectCSS = new THREE.CSS3DObject(element);
  objectCSS.position.x = Math.random() * 4000 - 2000;
  objectCSS.position.y = Math.random() * 4000 - 2000;
  objectCSS.position.z = Math.random() * 4000 - 2000;

  scene.add(objectCSS);
  objects.push(objectCSS);

  // table layout
  const object = new THREE.Object3D();

  const cols = 20;
  const col = i % cols;
  const row = Math.floor(i / cols);

  object.position.x = col * 140 - (cols * 140) / 2;
  object.position.y = -row * 180 + 800;
  object.position.z = 0;

  targets.table.push(object);
}


  /* Sphere */
  const vector = new THREE.Vector3();
  for (let i = 0, l = objects.length; i < l; i++) {
    const phi = Math.acos(-1 + (2 * i) / l);
    const theta = Math.sqrt(l * Math.PI) * phi;

    const object = new THREE.Object3D();
    object.position.setFromSphericalCoords(800, phi, theta);
    vector.copy(object.position).multiplyScalar(2);
    object.lookAt(vector);
    targets.sphere.push(object);
  }

  /* Helix */
for (let i = 0, l = objects.length; i < l; i++) {
  const theta = i * 0.175;
  const y = -(i * 8) + 450;
  const radius = 900;

  const object = new THREE.Object3D();

  object.position.setFromCylindricalCoords(
    radius,
    theta + (i % 2 === 0 ? 0 : Math.PI),
    y
  );

  targets.helix.push(object);
}


  /* Grid */
  for (let i = 0; i < objects.length; i++) {
    const object = new THREE.Object3D();
    object.position.x = ((i % 5) * 400) - 800;
    object.position.y = (-(Math.floor(i / 5) % 4) * 400) + 800;
    object.position.z = (Math.floor(i / 20)) * 1000 - 2000;
    targets.grid.push(object);
  }

  renderer = new THREE.CSS3DRenderer();
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  controls = new THREE.TrackballControls(camera, renderer.domElement);
  controls.minDistance = 500;
  controls.maxDistance = 6000;

  document.getElementById('table').onclick = () => transform(targets.table, 2000);
  document.getElementById('sphere').onclick = () => transform(targets.sphere, 2000);
  document.getElementById('helix').onclick = () => transform(targets.helix, 2000);
  document.getElementById('grid').onclick = () => transform(targets.grid, 2000);

  transform(targets.table, 2000);
}

function transform(targets, duration) {
  TWEEN.removeAll();

  for (let i = 0; i < objects.length; i++) {
    const object = objects[i];
    const target = targets[i];

    new TWEEN.Tween(object.position)
      .to({
        x: target.position.x,
        y: target.position.y,
        z: target.position.z
      }, Math.random() * duration + duration)
      .easing(TWEEN.Easing.Exponential.InOut)
      .start();

    new TWEEN.Tween(object.rotation)
      .to({
        x: target.rotation.x,
        y: target.rotation.y,
        z: target.rotation.z
      }, Math.random() * duration + duration)
      .easing(TWEEN.Easing.Exponential.InOut)
      .start();
  }
}

function animate() {
  requestAnimationFrame(animate);
  TWEEN.update();
  controls.update();
  renderer.render(scene, camera);
}
</script>

</body>
</html>

